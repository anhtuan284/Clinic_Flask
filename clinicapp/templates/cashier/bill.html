{% extends 'layout/base.html' %}

{% block title %}Thanh Toán{% endblock %}

{% block content %}
<h1 class="text text-center text-primary mt-3">HOÁ ĐƠN THANH TOÁN</h1>

<form method="post" action="/bills/{{prescription.id}}">
    <div class="d-flex">
        <div class="form-group p-1 flex-fill">
            <label for="name">Họ Tên</label>
            <input type="text" class="form-control" id="name" name="name"
                   value="{{patient.name}}"
                   readonly required>
        </div>

        <div class="form-group p-1 flex-fill">
            <label for="date">Ngày tạo phiếu khám</label>
            <input type="date" class="form-control" id="date" name="date"
                   value="{{prescription.date}}"
                   readonly required>
        </div>

    </div>

    <div class="d-flex">
        <div class="form-group flex-fill">
            <label for="medicines">Thuốc được kê</label>
            <select class="form-control" id="medicines" name="medicines" multiple disabled>
                {%for MD, M, MU, U in medicines%}
                <option>
                    {{M.name}}; {{MD.usage}}; {{MD.quantity}} {{U.name}} ({{U.name}} có {{MU.quantity}} viên)
                </option>
                {%endfor%}
            </select>

        </div>

    </div>

    <div class="d-flex">
        <div class="form-group m-1 flex-fill">
            <label for="service_price">Tiền khám</label>
            <input type="number" class="form-control" id="service_price" name="service_price"
                   value="{{service_price}}"
                   readonly required>
            {%if is_paid%}<p class="text text-primary">Đã trả tiền khám rồi</p>{%endif%}
        </div>

        <div class="form-group m-1 flex-fill">
            <label for="medicine_price">Tiền Thuốc</label>
            <input type="number" class="form-control" id="medicine_price" name="medicine_price"
                   value="{{medicine_price}}"
                   readonly required>
        </div>

    </div>

    <div class="form-group">
        <label for="total">Tổng Tiền</label>
        <input type="number" class="form-control" id="total" name="total"
               value="{{total}}"
               readonly required>
    </div>

    {%if error%}
        <div class="d-flex flex-row-reverse">
            <h1 class="text text-center text-danger">{{error}}</h1>
        </div>
        <div class="d-flex flex-row-reverse">
            <a class="btn btn-outline-primary" href="/payment">Chọn phiếu khám khác</a>
        </div>
    {%else%}
        {%if not created%}
            <div class="form-floating mt-3 mb-3 d-flex justify-content-around">
                <div class="form-check">
                    <input type="radio"
                           class="form-check-input"
                           id="radio_online"
                           name="optradio"
                           onclick="displayOnlinePayment()"
                           value="radio_online"
                           checked>
                    <label class="form-check-label" for="radio_online">Thanh toán Online</label>
                </div>
                <div class="form-check">
                    <input type="radio"
                           class="form-check-input"
                           id="radio_offline"
                           name="optradio"
                           onclick="displayOfflinePayment()"
                           value="radio_offline">
                    <label class="form-check-label" for="radio_offline">Thanh toán trực tiếp</label>
                </div>
            </div>
            <div id="xuat-hoa-don">
            </div>
        {%else%}
            <div class="d-flex flex-row-reverse">
                <h1 class="text text-center text-success">Hoá đơn xác nhận thành công</h1>
            </div>
            <div class="d-flex flex-row-reverse">
                <a class="btn btn-outline-primary" href="/payment">Chọn phiếu khám khác</a>
            </div>

        {%endif%}
    {%endif%}
</form>

<script src="{{ url_for('static', filename='js/cashier.js') }}"></script>

{% endblock %}